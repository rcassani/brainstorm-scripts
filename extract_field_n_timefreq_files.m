% Extract values for multiple TimeFreq files in Brainstorm
%
% Raymundo Cassani, 2022

% Input files
sFiles = {...
    'Subject01/S01_AEF_20131218_01_600Hz_notch/timefreq_trial001_morlet_220711_1753.mat', ...
    'Subject01/S01_AEF_20131218_01_600Hz_notch/timefreq_trial002_morlet_220711_1753.mat', ...
    'Subject01/S01_AEF_20131218_01_600Hz_notch/timefreq_trial003_morlet_220711_1753.mat'};

% Output files
sFilesOut = cell(size(sFiles));

% Loop over files
for iFile = 1 : length(sFiles)
    
    % Process: Extract values: [0ms,800ms] 7-12Hz
    tmp = bst_process('CallProcess', 'process_extract_values', sFiles{iFile}, [], ...
        'timewindow', [0, 0.8], ...
        'freqrange',  [7, 12], ...
        'rows',       '', ...
        'isabs',      0, ...
        'avgtime',    0, ...
        'avgrow',     0, ...
        'avgfreq',    0, ...
        'matchrows',  0, ...
        'dim',        2, ...  % Concatenate time (dimension 2)
        'Comment',    '');
    % sFilesOut FileName
    sFilesOut{iFile} = tmp.FileName;
end

